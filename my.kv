<Main>

    tab_width: (self.content.width - 5) / 5
    do_default_tab: False
    padding: (5, 5)
    tab_pos: 'bottom_mid'
    background_color: (0.64, 0.82, 0.94, 0.6)

    TabbedPanelItem:
        font_size: 0.15 * self.width
        font_name: "Corbel"
        background_color: (0, 0, 0, 0.9)
        id: datatable
        text: 'History'
        RecycleView:
            viewclass: 'CustomLabel'
            id: table_floor

            RecycleGridLayout:
                id: table_floor_layout
                cols: 4
                default_size:(None, 250)
                default_size_hint: (1, None)
                height: self.minimum_height
                spacing: 5

    TabbedPanelItem:
        font_size: 0.15 * self.width
        text: 'Transactions'
        background_color: (0, 0, 0, 0.9)
        FloatLayout:
            Spinner:
                pos_hint: {'center_x': 0.3, 'center_y': 0.9}
                font_size: 0.2 * self.width
                size_hint: 0.2, 0.1

                id: frombutton
                font_name: "Corbel"
                background_color: (0.64, 0.64, 0.64, 0.25)

                text: 'from'
                values: app.assets_held
                on_text:
                    app.currency1 = self.text
            Spinner:
                pos_hint: {'center_x': 0.7, 'center_y': 0.9}
                font_size: 0.2 * self.width
                size_hint: 0.2, 0.1

                id: tobutton
                font_name: "Corbel"
                background_color: (0.64, 0.64, 0.64, 0.25)

                text: 'to'
                values: 'BTC', 'PLN', 'CHF', 'EUR', 'USD'
                on_text:
                    app.currency2 = self.text
            TextInput:
                pos_hint: {'center_x': 0.5, 'center_y': 0.8}
                font_size: 0.08 * self.width
                size_hint: 0.4, 0.1
                text: ''
                halign: 'center'
                input_filter: "float"
                on_focus: app.volume = self.text
                id: valueinput
            Spinner:
                pos_hint: {'center_x': 0.3, 'center_y': 0.5}
                font_size: 0.2 * self.width
                size_hint: 0.2, 0.1

                id: yearbutton
                font_name: "Corbel"
                background_color: (0.64, 0.64, 0.64, 0.25)

                text:'Year'
                values: '2018', '2019', '2020', '2021', '2022'
                on_text:
                    app.dateyear = self.text
            Spinner:
                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                font_size: 0.2 * self.width
                size_hint: 0.2, 0.1

                id: monthbutton
                font_name: "Corbel"
                background_color: (0.64, 0.64, 0.64, 0.25)

                text:'Month'
                values: '01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12',
                on_text:
                    app.datemonth = self.text
            Spinner:
                pos_hint: {'center_x': 0.7, 'center_y': 0.5}
                font_size: 0.2 * self.width
                size_hint: 0.2, 0.1

                id: daybutton
                font_name: "Corbel"
                background_color: (0.64, 0.64, 0.64, 0.25)

                text:'Day'
                values: '01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '30', '31'
                on_text:
                    app.dateday = self.text
            Button:
                pos_hint: {'center_x': 0.5, 'center_y': 0.3}
                font_size: 0.2 * self.width
                font_name: "Corbel"
                background_color: (0.64, 0.64, 0.64, 0.25)
                text: 'submit'
                size_hint: 0.5, 0.2
                on_press: 
                    app.make_transaction(app.conn_tr, app.date_to_epoch(app.dateyear, app.datemonth, app.dateday), app.currency1, app.currency2, app.volume)
                    valueinput.text = ''
                    yearbutton.text = 'Year'
                    monthbutton.text = 'Month'
                    daybutton.text = 'Day'
                    tobutton.text = 'to'
                    frombutton.text = 'from'
                    app.open_popup()


    TabbedPanelItem:
        font_size: 0.15 * self.width
        font_name: "Corbel"
        text: 'Charts'
        background_color: (0, 0, 0, 0.9)
        FloatLayout:
            Image:
                pos_hint: {'center_x': 0.5, 'center_y': 0.7}
                size_hint: 1, 0.3
                id: _chart_img
                source: 'foo.png'
                allow_stretch: True
                keep_ratio: False
                #size: self.parent.size
            Spinner:
                size_hint: 0.2, 0.1

                font_size: 0.15 * self.width
                font_name: "Corbel"
                pos_hint: {'center_x': 0.3, 'center_y': 0.4}
                text: 'Interval'
                background_color: (0.64, 0.64, 0.64, 0.25)
                values: '1m', '5m', '15m', '1h', '1d', '5d', '1wk', '1mo'
                on_text:
                    app.interval = self.text
            Spinner:
                size_hint: 0.2, 0.1

                font_size: 0.15 * self.width
                font_name: "Corbel"
                pos_hint: {'center_x': 0.7, 'center_y': 0.4}
                text: 'Period'
                background_color: (0.64, 0.64, 0.64, 0.25)
                values: '1d', '5d', '1mo', '3mo', '6mo', '1y', '2y', '5y', '10y', 'ytd', 'max'
                on_text:
                    app.period = self.text
            Spinner:
                size_hint: 0.2, 0.1

                font_size: 0.15 * self.width
                font_name: "Corbel"
                pos_hint: {'center_x': 0.5, 'center_y': 0.4}
                text: 'Asset'
                background_color: (0.64, 0.64, 0.64, 0.25)
                values: app.assets_held
                on_text:
                    app.asset = self.text
            Button:
                size_hint: 0.2, 0.1

                font_size: 0.15 * self.width
                font_name: "Corbel"
                pos_hint: {'center_x': 0.5, 'center_y': 0.2}
                text: 'Show'
                background_color: (0.18, 0.48, 0.25, 0.8)
                on_press:
                    app.stock_data(app.asset ,app.period,app.interval, 'Open')
                on_release:
                    app.update_chart()



    TabbedPanelItem:
        font_size: 0.15 * self.width
        font_name: "Corbel"
        text: 'Portfolio'
        background_color: (0, 0, 0, 0.9)
        FloatLayout:
            Image:
                pos_hint: {'center_x': 0.5, 'center_y': 0.7}
                size_hint: 1, 0.3
                id: _chart_img2
                source: 'foo2.png'
                allow_stretch: True
                keep_ratio: False
                #size: self.parent.size
            Spinner:
                id: assetname
                size_hint: 0.2, 0.1
                font_size: 0.15 * self.width
                font_name: "Corbel"
                pos_hint: {'center_x': 0.5, 'center_y': 0.4}
                text: 'Asset'
                background_color: (0.64, 0.64, 0.64, 0.25)
                values: app.assets_held
                on_text:
                    app.asset = self.text
            Button:
                size_hint: 0.2, 0.1

                font_size: 0.15 * self.width
                font_name: "Corbel"
                pos_hint: {'center_x': 0.5, 'center_y': 0.2}
                text: 'Show'
                background_color: (0.18, 0.48, 0.25, 0.8)
                on_press:
                    app.historical_value(app.asset)
                on_release:
                    app.update_chart(app.value(app.asset))
            Button:
                size_hint: 0.2, 0.1

                font_size: 0.15 * self.width
                font_name: "Corbel"
                pos_hint: {'center_x': 0.8, 'center_y': 0.2}
                text: 'Show total'
                background_color: (0.18, 0.48, 0.25, 0.8)
                on_press:
                    app.portfolio_values()
                    assetname.text = "TOTAL"
                on_release:
                    app.update_chart2()
                    assetname.text = "TOTAL"
            Label:
                text: "Current volume of the asset"
                font_size: 0.02 * self.width
                font_name: "Corbel"
                pos_hint: {'center_x': 0.5, 'center_y': 0.1}
            Label:
                text: "Current value of portfolio"
                font_size: 0.02 * self.width
                font_name: "Corbel"
                pos_hint: {'center_x': 0.8, 'center_y': 0.1}
            Label:
                id: labelval
                text: ''
                font_name: "Corbel"
                font_size: 0.03 * self.width
                pos_hint: {'center_x': 0.5, 'center_y': 0.05}
            Label:
                id: labelportfolio
                pos_hint: {'center_x': 0.8, 'center_y': 0.05}
                font_size: 0.03 * self.width
                font_name: "Corbel"
                text: str(app.current_portfolio_value())
    TabbedPanelItem:
        font_size: 0.15 * self.width
        font_name: "Corbel"
        background_color: (0, 0, 0, 0.9)
        text: app.news()
        BoxLayout:
            orientation: 'vertical'
            Button:
                canvas.before:
                    Color:
                        rgba: 0, 0, 0, 1
                    Line:
                        width: 1
                        rectangle: self.x, self.y, self.width, self.height
                font_size: 0.02 * self.width
                text: app.news1
                background_color: (0.18, 0.48, 0.25, 0.8)
                on_press: app.browser(app.link1)
                font_name: "Corbel"
            Button:
                canvas.before:
                    Color:
                        rgba: 0, 0, 0, 1
                    Line:
                        width: 1
                        rectangle: self.x, self.y, self.width, self.height
                font_size: 0.02 * self.width
                text: app.news2
                font_name: "Corbel"
                background_color: (0.18, 0.48, 0.25, 0.8)
                on_press: app.browser(app.link2)
            Button:
                canvas.before:
                    Color:
                        rgba: 0, 0, 0, 1
                    Line:
                        width: 1
                        rectangle: self.x, self.y, self.width, self.height
                font_size: 0.02 * self.width
                text: app.news3
                background_color: (0.18, 0.48, 0.25, 0.8)
                on_press: app.browser(app.link3)
                font_name: "Corbel"
<CustomLabel@Label>:
    bcolor: (1,1,1,1)
    canvas.before:
        Color:
            rgba: root.bcolor
        Rectangle:
            size: self.size
            pos: self.pos

<P>:
    Label:
        id: popup_window
        text: 'Transaction has been sucesfully added'
        size_hint: 0.6, 0.2
        pos_hint: {"x": 0.2, "top": 1}

